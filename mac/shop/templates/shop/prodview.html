{% extends 'shop/basic.html' %}

{% block title%} {{product.product_name}} - Trendy Home Mart{% endblock %}
{% block body %}
<!--<div class="container my-4">-->
    <!--<div class="row">-->
    <!--<div class="col_md_4">-->
    <!--<div class = "row">-->
        <!--<img src="/media/{{product.image}}" class="rounded" width="233px" height="383px">-->

    <!--</div>-->
        <!--<div class="row">-->
            <!--<button class="btn btn-danger mx-3 my-3">Buy Now</button>-->
            <!--<button class="btn btn-danger my-3 ">Add To Cart</button>-->
        <!--</div>-->

    <!--</div>-->
    <!--<div class="col-md-8 mx-5">-->
        <!--<h2>{{product.product_name}}</h2>-->
        <!--<p><b></b></p>-->

        <!--<p><b>Rs.{{product.price}} </b></p>-->
        <!--<p>{{product.desc}}</p>-->
    <!--</div>-->
    <!--</div>-->
 <!--Main layout-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="css/mdb.min.css" rel="stylesheet">
  <!-- Your custom styles (optional) -->
  <link href="css/style.min.css" rel="stylesheet">
</head>
  <main class="mt-5 pt-4">
    <div class="container dark-grey-text mt-5">

      <!--Grid row-->
      <div class="row wow fadeIn">

        <!--Grid column-->
        <div class="col-md-6 mb-4">

          <img src="/media/{{product.image}}" class="img-fluid" alt="">

        </div>
        <!--Grid column-->

        <!--Grid column-->
        <div class="col-md-6 mb-4">

          <!--Content-->
          <div class="p-4">



            <p class="lead">
              <span class="mr-1">
                <h1>{{product.product_name}}</h1>
                <!--<del>{{product.product_name}}</del>-->
              </span>
              <span>Rs.{{product.price}} <strong> Price after Discount</strong></span><br>
              <span><strong><del>Rs.{{product.price}}</del></strong></span>

            </p>

            <p class="lead font-weight-bold">Description</p>

            <p>{{product.desc}}</p>

            <form class="d-flex justify-content-left">
              <!-- Default input -->
              <!--<input type="number" value="1" aria-label="Search" class="form-control" style="width: 100px">-->
              <button class="btn btn-danger btn-md my-0 p" type="submit" id="pr{{i.id}}" class="btn btn-danger cart" >Add to card<i class="fas fa-shopping-cart ml-1"></i>

              </button>

            </form>

          </div>
          <!--Content-->

        </div>
        <!--Grid column-->

      </div>
      <!--Grid row-->

      <hr>

      <!--Grid row-->
      <div class="row d-flex justify-content-center wow fadeIn">

        <!--Grid column-->
        <div class="col-md-6 text-center">

          <h4 class="my-4 h4">Additional information</h4>

          <p><strong>{{product.desc}}</strong></p>

        </div>
        <!--Grid column-->

      </div>
      <!--Grid row-->

      <!--Grid row-->
      <div class="row wow fadeIn">

        <!--Grid column-->
        <div class="col-lg-4 col-md-12 mb-4">

          <img src="/media/{{product.image}}" class="img-fluid" alt="">

        </div>
        <!--Grid column-->

        <!--Grid column-->
        <div class="col-lg-4 col-md-6 mb-4">

          <img src="/media/{{product.image}}" class="img-fluid" alt="">

        </div>
        <!--Grid column-->

        <!--Grid column-->
        <div class="col-lg-4 col-md-6 mb-4">

          <img src="/media/{{product.image}}" class="img-fluid" alt="">

        </div>
        <!--Grid column-->

      </div>
      <!--Grid row-->

    </div>
  </main>

  <!--Footer-->
  <footer class="page-footer text-center font-small mt-4 wow fadeIn">

    <!--Call to action-->
    <!--<div class="pt-4">-->
      <!--<a class="btn btn-outline-white" href="https://mdbootstrap.com/docs/jquery/getting-started/download/" target="_blank"-->
        <!--role="button">Download MDB-->
        <!--<i class="fas fa-download ml-2"></i>-->
      <!--</a>-->
      <!--<a class="btn btn-outline-white" href="https://mdbootstrap.com/education/bootstrap/" target="_blank" role="button">Start-->
        <!--free tutorial-->
        <!--<i class="fas fa-graduation-cap ml-2"></i>-->
      <!--</a>-->
    <!--</div>-->
    <!--/.Call to action-->

    <hr class="my-4">

    <!-- Social icons -->
    <div class="pb-4">
      <a href="https://www.facebook.com/" target="_blank">
        <i class="fab fa-facebook-f mr-3"></i>
      </a>


      <a href="https://www.youtube.com/" target="_blank">
        <i class="fab fa-youtube mr-3"></i>
      </a>

      <a href="https://plus.google.com/u/0/b/107863090883699620484" target="_blank">
        <i class="fab fa-google-plus-g mr-3"></i>
      </a>

      <!--<a href="https://dribbble.com/mdbootstrap" target="_blank">-->
        <!--<i class="fab fa-dribbble mr-3"></i>-->
      <!--</a>-->

      <!--<a href="https://pinterest.com/mdbootstrap" target="_blank">-->
        <!--<i class="fab fa-pinterest mr-3"></i>-->
      <!--</a>-->

      <!--<a href="https://github.com/mdbootstrap/bootstrap-material-design" target="_blank">-->
        <!--<i class="fab fa-github mr-3"></i>-->
      <!--</a>-->

      <!--<a href="http://codepen.io/mdbootstrap/" target="_blank">-->
        <!--<i class="fab fa-codepen mr-3"></i>-->
      <!--</a>-->
    </div>
    <!-- Social icons -->

    <!--Copyright-->
    <div class="footer-copyright py-3">
      Â© 2019 Copyright:
      <a href="https://mdbootstrap.com/education/bootstrap/" target="_blank"> WWW.trendyhomemart.com </a>
    </div>
    <!--/.Copyright-->

  </footer>
  <!--/.Footer-->

  <!-- SCRIPTS -->
  <!-- JQuery -->
  <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
  <!-- Bootstrap tooltips -->
  <script type="text/javascript" src="js/popper.min.js"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="js/mdb.min.js"></script>
  <!-- Initializations -->
  <script type="text/javascript">
    // Animations initialization
    new WOW().init();

  </script>


</div>



{% endblock %}


{% block js %}
<script>
// Find out the cart items from localStorage
if (localStorage.getItem('cart') == null) {
    var cart = {};
} else {
    cart = JSON.parse(localStorage.getItem('cart'));
    updateCart(cart);
}
// If the add to cart button is clicked, add/increment the item
//$('.cart').click(function() {
    $('.divpr').on('click', 'button.cart', function(){
    var idstr = this.id.toString();
    if (cart[idstr] != undefined) {
        qty=cart[idstr][0] + 1;

    } else {
        qty=1;
        name =document.getElementById('name'+ idstr).innerHTML;
        price =document.getElementById('price'+ idstr).innerHTML;
        cart[idstr] = [qty,name,parseInt(price)];
    }
    updateCart(cart);
});
//Add Popover to cart
$('#popcart').popover();
updatePopover(cart);
function updatePopover(cart) {
    console.log('We are inside updatePopover');
    var popStr = "";
    popStr = popStr + "<h5> Cart for your items in my shopping cart </h5><div class='mx-2 my-2'>";
    var i = 1;
    for (var item in cart) {
        popStr = popStr + "<b>" + i + "</b>. ";
        popStr = popStr + document.getElementById('name' + item).innerHTML.slice(0, 19) + "... Qty: " + cart[item][0] + '<br>';
        i = i + 1;
    }
    popStr = popStr + "</div> <a href='/shop/checkout'><button class='btn btn-danger' id ='checkout'>Checkout</button></a> <button class='btn btn-danger' onclick='clearCart()' id ='clearCart'>Clear Cart</button>     "
    console.log(popStr);
    document.getElementById('popcart').setAttribute('data-content', popStr);
    $('#popcart').popover('show');
}
function clearCart() {
    cart = JSON.parse(localStorage.getItem('cart'));
    for (var item in cart) {
        document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-danger cart">Add To Cart</button>'
    }
    localStorage.clear();
    cart = {};
    updateCart(cart);
}
function updateCart(cart) {
    var sum = 0;
    for (var item in cart) {
        sum = sum + cart[item][0];
        document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-danger minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-danger plus'> + </button>";
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    document.getElementById('cart').innerHTML = sum;
    console.log(cart);
    updatePopover(cart);
}
// If plus or minus button is clicked, change the cart as well as the display value
$('.divpr').on("click", "button.minus", function() {
    a = this.id.slice(7, );
    cart['pr' + a][0] = cart['pr' + a][0] - 1;
    cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    updateCart(cart);
});
$('.divpr').on("click", "button.plus", function() {
    a = this.id.slice(6, );
    cart['pr' + a][0] = cart['pr' + a][0] + 1;
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    updateCart(cart);
});
</script>
{% endblock %}


  <!--Main layout-->
